% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_sample_data.R
\name{clean_sample_data}
\alias{clean_sample_data}
\title{Perform QC checks and updates on raw output from SampleMaster}
\usage{
clean_sample_data(return_QC_meta = TRUE, add_lod_units = NULL)
}
\arguments{
\item{return_QC_meta}{Logical. If `TRUE`, writes a QC metadata workbook to the
input file directory with the suffix `_QC.xlsx`.}

\item{add_lod_units}{Optional data frame specifying additional LOD units.
Must contain columns `Parameter` and `units`.}
}
\value{
This function is called for its side effects. It writes cleaned data and
QC metadata to disk and returns `NULL` invisibly.
}
\description{
Accepts raw SampleMaster input and performs automated QC actions where
permissible, or stops with informative errors when manual intervention
is required. When the function completes without error, cleaned outputs
and QC metadata are written to the same directory as the input file.
}
\details{
The following QC actions are performed:
\itemize{
  \item Removes rows with invalid `Param` values (from `badparams`), if present.
  \item Renames `OrderDetails_*` columns to standardized names.
  \item Replaces field duplicate values in `Site` with `Location` where available.
  \item Errors if any `Site` values are missing and no `Location` is provided.
  \item Errors if `CollectTime` is missing for `Param` values SRP, NO2, or PTCoN.
  \item Replaces missing `SampleType` with `"Field Dup"` when field duplicates are identified.
  \item Flags results below the limit of detection (`<LOD`) in the `Result` column.
}


Two Excel workbooks are written to the input data directory if the function
completes without error:

\itemize{
  \item \strong{`*_QC.xlsx`}: A copy of the raw data with QC annotations.
  Contains the following columns:
  \describe{
    \item{QC_flag}{Short codes describing QC actions taken.}
    \item{QC_notes}{Detailed descriptions of QC actions.}
  }
  \item \strong{`*_cleaned.xlsx`}: The final cleaned dataset.
}
If any QC rule fails, execution stops and no output files are written.
Error messages include affected sample IDs when applicable to aid manual correction.
}
